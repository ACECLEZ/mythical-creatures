<!DOCTYPE html>
<html>

<head>
  <title>唤醒神兽-过关斩将</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>
  <div id="game-container">
  <div id="title">本周特刊《唤醒神兽：失落的记忆之九尾狐传说》</div> 
    <pre id="output"></pre>
    <input type="text" id="input" autocomplete="off" disabled>
  </div>

  <script>
    const outputElement = document.getElementById('output');
    const inputElement = document.getElementById('input');

    const delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));
// ...

const printText = async (text) => {
  const outputText = document.createElement('span');
  outputElement.appendChild(outputText);

  for (let i = 0; i < text.length; i++) {
    outputText.textContent += text[i];
    await delay(80);
  }

  // Hide previous speech elements
  const previousSpeechElements = outputElement.querySelectorAll('span');
  for (let i = 0; i < previousSpeechElements.length - 1; i++) {
    previousSpeechElements[i].classList.add('hidden');
  }

  await delay(1000); // Add a 1-second delay after finishing showing the current line of text
};

// ...



    const readLine = async () => {
      return new Promise((resolve) => {
        inputElement.disabled = false;
        inputElement.focus();

        const handleKeyDown = (event) => {
          if (event.key === 'Enter') {
            event.preventDefault();
            inputElement.removeEventListener('keydown', handleKeyDown);
            const inputValue = inputElement.value;
            inputElement.value = '';
            inputElement.disabled = true;
            resolve(inputValue);
          }
        };

        inputElement.addEventListener('keydown', handleKeyDown);
      });
    };

    const main = async () => {
      await printText('《唤醒神兽：失落的记忆之九尾狐传说》\n');
      await printText(
        '你将扮演一只年轻的狐狸，醒来时却发现自己失去了所有记忆。你将开始一段充满谜团和冒险的旅程，只有修炼成九尾狐，才能返回现实世界。\n'
      );
      await printText(
        '你在一片陌生的森林中苏醒。四周环绕着茂密的树木和神秘的氛围。你不记得自己是谁，也不知道身处何地，只发现自己变成了一只狐狸。\n'
      );
      await printText(
        '这时候你遇到了一位神灵，他会在你的旅途中帮助你。不过这当然不是无偿的，你必须答对他的问题，才能获得线索。\n'
      );
      await printText(
        '神灵：本人姓刘名小衫，看你那么可怜，就勉为其难帮你一下。修炼成九尾狐可没那么简单，你可知道九尾狐在《山海经》中的属性吗。\n'
      );
      await printText('选项：金，木，水，火，土\n');
      const input = await readLine();
      await printText('\n');
      if (input === '火') {
        await printText(
          '看来你还是有点能力的吗。给你补充一点背景知识，《大荒东经》说：“有青丘之国，有狐九尾。”后来又有各种文献记载，一些天子建立朝代或者赢得战争时，就有九尾狐的出现。别忘了哈，别怪我没提醒你。\n'
        );
      } else {
        await printText(
          '连这都不知道还想修炼成九尾狐？这次就帮帮你，九尾狐的属性是火。给你补充一点背景知识，《大荒东经》说：“有青丘之国，有狐九尾。”后来又有各种文献记载，一些天子建立朝代或者赢得战争时，就有九尾狐的出现，所以承载着顺遂美好、多子多福的祈愿。别忘了哈，别怪我没提醒你。\n'
        );
      }
      // Continue with the rest of the game...
      // Start of scene 2
      await printText(
        '传说世间的狐狸是非常有灵性的生灵，可修炼成仙。一只虔诚的狐狸只要帮助它的主人实现一个愿望，狐狸就会多长出一条尾巴，等到有九条尾巴的时候，就可以顺利成仙了。\n'
      );
      await printText(
        '世间就有这么一只小狐狸，为了实现自己成仙的梦想，经常见到人就会问“你有什么愿望要实现吗？”，然后被问的人就会告诉它想要什么什么，这只小狐狸呢就会认认真真的去帮助别人去实现他的愿望。\n'
      );
      await printText(
        '神灵：现在我手上有两幅地图，决定了你的出发点。其中一个地图会将你带到荒无人烟的沙漠，另一个会把你带到小镇。《文字中的神兽》：“狐 _ 虎 _”\n'
      );
      const inputScene2 = await readLine();
      await printText('\n');
      if (inputScene2 === '狐假虎威') {
        await printText('诺，拿好了，我们现在就去镇上。\n');
      } else {
        await printText('神灵：再给你个提示：狐 _ 虎 威\n');
        await printText('再试一次吧！\n');
        const inputScene2Retry = await readLine();
        await printText('\n');
        if (inputScene2Retry === '狐假虎威') {
          await printText('诺，拿好了，我们现在就去镇上。\n');
        } else {
          await printText('就你这水平还想成仙？回去再练个500年吧！\n');
          await printText('游戏失败！\n');
          return;
        }
      }
      // End of scene 2

      // Start of scene 3
      await printText(
        '你的下一个考验是找出九尾狐是邪恶的象征还是吉祥的象征。只要回答正确就可以获得最后一条尾巴，修炼成九尾狐。选项：是，不是\n'
      );
      await printText('神灵：仔细想想，还记得我之前说过什么吗\n');
      const inputScene3 = await readLine();
      await printText('\n');
      if (inputScene3 !== '都是') {
        await printText('回答错误！\n');
      }
      await printText('神灵：还得靠我，回答出九尾狐的属性就给你一瓶复活水。选项：金，木，水，火，土\n');
      const inputScene3Attribute = await readLine();
      await printText('\n');
      if (inputScene3Attribute === '火') {
        await printText('继续探索吧。\n');
      } else {
        await printText('就你这水平还想成仙？回去再练个500年吧！\n');
        await printText('游戏失败！\n');
        return;
      }
      await printText(
        '小镇上熙熙攘攘，人们忙碌地走来走去。狐狸潜伏在人群中，试图寻找一些有关九尾狐的传说或是关于他自己的线索。\n'
      );
      await printText(
        '他听到一群人在谈论关于九尾狐的传说。据说，九尾狐拥有神奇的力量，能够掌控火焰和幻术，还能够赋予人类智慧和长寿。人们对九尾狐充满着敬畏和向往，但也有些人将其视为邪恶的象征。\n'
      );
      await printText(
        '你决定深入了解这个传说，并寻找九尾狐的蛛丝马迹。他悄悄进入了一座古老的图书馆，希望能够找到更多的关于九尾狐的资料。\n'
      );
      await printText(
        '在图书馆里，狐狸翻阅了许多古老的书籍和文献。他发现了一本关于九尾狐的传说的秘籍，里面写道在宋代以前九尾狐是属于祥兽，在春秋战国时期发掘出的墓葬群，其墓室壁画不乏有九尾狐与四神兽一起的图画，另有说法指出九尾狐为西王母的座骑，且其毛色单一，故有着谦逊之意。\n'
      );
      await printText(
        '你并没有忘记主线任务，在小镇里默默帮助着居民。没多久，就长出了八条尾巴。\n'
      );
      await printText(
        '但是你这只虔诚的狐狸发现长到第八条尾巴之后，也不知道继续帮多少人实现了愿望，但仍然长不出第九条尾巴，所以呀，这只小狐狸就跑到佛祖面前去抱怨，“我都帮那么多人实现了他们的愿望，为什么还是长不出第九条尾巴？”，小狐狸觉得很委屈，佛祖只是笑而不答，小狐狸只得耷拉着耳朵回到了人间，继续修炼它的修炼。\n'
      );
      await printText(
        '神灵：给你个小提示，约宋代后，九尾狐才开始偏向魅惑、欺骗等形象。及至明代小说《封神演义》成书后，九尾狐为恶兽的观念已大致成定局；在《封神演义》中，九尾狐乃奉女娲之命前去诱惑商纣王，而后周武王伐纣，九尾狐化身妲己，做了许多坏事让纣王失去了民心与江山。民间传说亦流传九尾狐会化身各种人物以媚惑欺骗，因此狐狸便成为狡猾的代名词。\n'
      );
      await printText(
        '结合所获得的所有线索，回答以下问题：九尾狐是邪恶的象征还是吉祥的象征？选项：是，不是，都是\n'
      );
      const inputScene3Answer = await readLine();
      await printText('\n');
      if (inputScene3Answer === '都是') {
        await printText('恭喜你，回答正确！\n');
      } else {
        await printText('就你这水平还想成仙？回去再练个500年吧！\n');
        await printText('游戏失败！\n');
        return;
      }
      await printText('小狐狸长出了华丽的第九条尾巴，变成了真正的九尾狐。\n');
      await printText('制作：@唤醒神兽团队\n');
      // End of scene 3

    };

    main();
  </script>

  <style>
body {
  background-color: #111;
  color: #fff;
  font-family: "Press Start 2P", cursive;
  text-align: center;
  margin-top: 20vh;
}

#game-container {
  width: 600px;
  margin: 0 auto;
  border: 2px solid #fff;
  padding: 10px;
  overflow: hidden;
  max-height: 300px;
  background-color: #000;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

#output {
  height: 280px;
  padding: 0;
  margin: 0;
  font-size: 18px;
  overflow-wrap: break-word;
  white-space: pre-wrap;
  display: flex;
  align-items: flex-end;
  color: #fff;
}

#output span {
  display: none; /* Hide all output text by default */
}

#output span:last-child {
  display: inline; /* Only display the latest speech */
}

#input {
  width: 100%;
  padding: 5px;
  font-size: 18px;
  background-color: transparent;
  border: none;
  outline: none;
  color: #fff;
}

/* Hide the scrollbar for #output */
#output::-webkit-scrollbar {
  width: 0.8em;
}

#output::-webkit-scrollbar-thumb {
  background-color: #fff;
}

#output::-webkit-scrollbar-track {
  background-color: #000;
}

/* Hide the up/down arrows in #input */
input[type="text"]::-webkit-inner-spin-button,
input[type="text"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.hidden {
  display: none;
}


#title {
  position: absolute;
  top: 0;
  right: 0;
  padding: 5px 10px;
  background-color: #000;
  color: #fff;
  font-size: 14px;
}
  </style>

</body>

</html>
